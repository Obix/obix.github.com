<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 11. Enumerated type</title><link rel="stylesheet" href="obix_doc.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="index.html" title="Obix programming language documentation"><link rel="up" href="bk01pt03.html" title="Part III. Advanced concepts"><link rel="prev" href="bk01pt03ch10.html" title="Chapter 10. Embedded Java source code"><link rel="next" href="bk01pt03ch12.html" title="Chapter 12. Void values"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 11. Enumerated type</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="bk01pt03ch10.html">Prev</a> </td><th width="60%" align="center">Part III. Advanced concepts</th><td width="20%" align="right"> <a accesskey="n" href="bk01pt03ch12.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="enumerated_type"></a>Chapter 11. Enumerated type</h2></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="enumerated_type_description"></a>Description</h2></div></div></div><p>An <em class="firstterm">enumerated type</em> defines a fixed set of values which are distinguished through a unique name.</p><p>Enumerated types are used whenever an object's value at runtime is a named value among a defined set of possible named values. For example:</p><div class="itemizedlist"><ul type="disc"><li><p>enumerated type <code class="code">size</code> defines the following possible named values: <code class="code">small</code>, <code class="code">medium</code> and <code class="code">large</code>.</p></li><li><p>enumerated type <code class="code">quality</code> defines the following possible named values: <code class="code">very_bad</code>, <code class="code">bad</code>, <code class="code">standard</code>, <code class="code">good</code>, and <code class="code">very_good</code>.</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="enumerated_type_rules"></a>Rules</h2></div></div></div><p>Enumerated types are governed by the following rules:</p><div class="orderedlist"><ol type="1"><li><p><span class="emphasis"><em>The name of an enumerated value consists of a prefixed identifier starting with <code class="code">en_</code> as prefix.</em></span></p><p>As for all prefixed identifiers, writing the prefix in source code is optional, as long as there is no ambiguity detected by the compiler. Hence, writing <code class="code">small</code> is equivalent to writing <code class="code">en_small</code>.</p></li><li><p>The syntax to define an enumerated type is as follows:</p><div class="table"><a name="enumerated_type_syntax"></a><p class="title"><b>Table 11.1. Enumerated type</b></p><div class="table-contents"><table summary="Enumerated type" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">enumerated_type</code></td><td>
                <div class="literallayout"><p><code class="code">"type" ( "id" ":" ) ? <a href="bk02ch03.html#EBNF_type_id">type_id</a><br>
   "enumerated" <a href="bk02ch03.html#EBNF_enumerated_id">enumerated_id</a> ( ";" <a href="bk02ch03.html#EBNF_enumerated_id">enumerated_id</a> ) * "end"<br>
"end" "type" ?</code></p></div>
              </td><td><a href="bk01pt03ch11.html" title="Chapter 11. Enumerated type">Chapter 11, <i>Enumerated type</i></a></td></tr></tbody></table></div></div><br class="table-break"><p>Example:</p><pre class="programlisting">type SML_size 

   enumerated small; medium; large end

end</pre></li><li><p><span class="emphasis"><em>No factory needs to be created for an enumerated type.</em></span></p><p>A unique object for each value of each enumerated type is automatically created at runtime.</p></li><li><p><span class="emphasis"><em>If the type of an object reference (attribute, input argument, output argument, constant or variable) is an enumerated type, then the syntax used to declare the object reference's type is: <code class="code">enumerated_type_identifier.enumerated</code>, and a value of an enumerated type is accessed with the syntax <code class="code">enumerated_type_identifier.enumerated_value_identifier</code>.</em></span></p><p>Example:</p><pre class="programlisting">service enumerated_examples

   command example_1
      script

         // declare variable 'size' of enumerated type 'SML_size'
         var SML_size.enumerated size

         // assign value 'large' to variable 'size'
         size = SML_size.large

         // same instruction with prefixed identifiers:
         v_size = ty_SML_size.en_large
      end
   end

end</pre></li><li><p><span class="emphasis"><em>All objects of an enumerated type are themselves instances of type <code class="code">enumerated</code>.</em></span></p><p>Type <code class="code">enumerated</code> is defined as follows:</p><pre class="programlisting">///
   Copyright (C) 2011 Christian Neumanns (www.obix.lu)
   This code can be used under the terms of the 'GNU Afero General Public License version 3'
   The full text of this license can be found at http://www.gnu.org/licenses/agpl.html
   THIS CODE IS DISTRIBUTED WITHOUT ANY WARRANTY. See the license for details.
end ///

type enumerated

	inherit !extended_comparable&lt;other:enumerated; min_max_result:enumerated&gt; end

	inherit prefixed_id_object
		attribute a_id type:enumerated_id end
	end

	inherit hashable end
	
	// attribute a_id type:enumerated_id end

	attribute a_index type:positive32 end

end type</pre><p>It follows from the above type definition that:</p><div class="itemizedlist"><ul type="disc"><li><p>two enumerated values can be compared (equal, greater than, less than), because type <code class="code">enumerated</code> inherits from type <code class="code">extended_comparable</code>. The magnitude of each value is determined through the order in which the values appear in the declaring type. Each value has a higher magnitude than its preceding value.</p></li><li><p>objects of type <code class="code">enumerated</code> can be used for keys in <code class="code">maps</code>, because type <code class="code">enumerated</code> inherits from type <code class="code">hashable</code>.</p></li><li><p>attribute <code class="code">id</code> provides the prefixed identifier for an enumerated value.</p></li><li><p>attribute <code class="code">index</code> provides a numeric integer value that is assigned to each enumerated value. The first enumerated value appearing in the declaring type starts with index 1, and the index is then incremented by one for each subsequent value.</p></li></ul></div></li><li><p><span class="emphasis"><em>Enumerated types are compile-time and run-time type-safe.</em></span></p><p>For example, suppose that:</p><div class="itemizedlist"><ul type="disc"><li><p>enumerated type <code class="code">size</code> defines the values <code class="code">small</code>, <code class="code">medium</code> and <code class="code">large</code>.</p></li><li><p>enumerated type <code class="code">quality</code> defines the values <code class="code">bad</code>, <code class="code">medium</code> and <code class="code">good</code>.</p></li></ul></div><p>In that case, an object of type <code class="code">size.enumerated</code> cannot be assigned to an object of type <code class="code">quality.enumerated</code>, and vice versa. Moreover, the values <code class="code">medium</code> of type <code class="code">size</code> and <code class="code">medium</code> of type <code class="code">quality</code> are semantically different, and thus incompatible, although their identifiers and indexes are the same.</p></li></ol></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="enumerated_type_rationale"></a>Rationale</h2></div></div></div><p>In some programming languages it is common to define enumerated values with integer or string constants.</p><p>An example of using integers in C is:</p><pre class="programlisting">typedef enum {SMALL, MEDIUM, LARGE} size;</pre><p>And an example of using strings in Java is shown below. (Note that Java also provides type-safe enum values since version 1.5)</p><pre class="programlisting">public class Quality {
   public static final String BAD      = "bad";
   public static final String STANDARD = "standard";
   public static final String GOOD     = "good";
}</pre><p>The above way of defining enumerated values always have a severe drawback: there is no type safety. This opens the door for many possible programming errors which can be difficult to detect, because the effect of a semantically incompatible value assigned to an enumerated object might be detected long after the wrong assignment took place. Therefore, the above way to work with enumerated values should never be used in Obix. Instead, an enumerated type should be used, in order to ensure compile-time and run-time type safety.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="enumerated_type_example"></a>Example</h2></div></div></div><p>Suppose the following type has been defined:</p><pre class="programlisting">type SML_size 

   enumerated small; medium; large end

end</pre><p>For each one of the above defined enumerated values, the following table shows the two attribute values of type <code class="code">enumerated</code>:</p><div class="table"><a name="enumerated_attributes"></a><p class="title"><b>Table 11.2. Attribute values of enumerated values</b></p><div class="table-contents"><table summary="Attribute values of enumerated values" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Enumerated value</th><th>Value of attribute <code class="code">id</code></th><th>Value of attribute <code class="code">index</code></th></tr></thead><tbody><tr><td><code class="code">small</code></td><td><code class="code">en_small</code></td><td><code class="code">1</code></td></tr><tr><td><code class="code">medium</code></td><td><code class="code">en_medium</code></td><td><code class="code">2</code></td></tr><tr><td><code class="code">large</code></td><td><code class="code">en_large</code></td><td><code class="code">3</code></td></tr></tbody></table></div></div><br class="table-break"><p>The following code demonstrates the rules explained above:</p><pre class="programlisting">service enumerated_examples

   command example_2
      script

         // declare and initialize some variables

         var SML_size.enumerated size_small = SML_size.small
         var SML_size.enumerated size_medium = SML_size.medium
         var SML_size.enumerated size_large = SML_size.large

         var SML_size.enumerated size_earth = SML_size.large

         // check attribute 'id' of type 'enumerated'

         check script size_small.id.to_string =v "en_small"
         check script size_small.id.suffix.to_string =v "small"

         check script size_earth.id.to_string =v "en_large"

         // check attribute 'index' of type 'enumerated'

         check script size_small.index =v 1
         check script size_medium.index =v 2
         check script size_large.index =v 3
         check script size_earth.index =v 3
         
         // compare values

         // greater than
         check script size_medium &gt; size_small
         check script size_large &gt; size_medium

         // less than
         check script size_small &lt; size_large

         // equal
         check script size_large =v size_earth // compare values
         check script size_large =r size_earth // compare references

         // unequal
         check script size_small #v size_large // compare values
         check script size_small #r size_large // compare references
      end
   end

end</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="bk01pt03ch10.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="bk01pt03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="bk01pt03ch12.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 10. Embedded Java source code </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 12. Void values</td></tr></table></div></body></html>
