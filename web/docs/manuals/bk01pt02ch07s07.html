<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>test script</title><link rel="stylesheet" href="obix_doc.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="index.html" title="Obix programming language documentation"><link rel="up" href="bk01pt02ch07.html" title="Chapter 7. Scripts"><link rel="prev" href="bk01pt02ch07s06s02.html" title="Input argument default script"><link rel="next" href="bk01pt02ch08.html" title="Chapter 8. Script instructions"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center"><code class="code">test</code> script</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="bk01pt02ch07s06s02.html">Prev</a> </td><th width="60%" align="center">Chapter 7. Scripts</th><td width="20%" align="right"> <a accesskey="n" href="bk01pt02ch08.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="test_script"></a><code class="code">test</code> script</h2></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_usage"></a>Usage</h3></div></div></div><p>There are two variations of test scripts:</p><div class="orderedlist"><ol type="1"><li><p>A <em class="firstterm">script <code class="code">test</code> script</em> belongs to a so-called <em class="firstterm">tested script</em>, which can be anyone of the scripts explained in the previous sections. A <span class="emphasis"><em>script test script</em></span> is used to test the correctness of the <span class="emphasis"><em>tested script</em></span> it belongs to. It does this by calling the tested script with different input conditions and checking the results for each call. If a result is different from the expected result, a test fail error is created and appended to a list of all encountered test fails.</p></li><li><p>A <em class="firstterm">RSE <code class="code">test</code> script</em> belongs to a RSE (type, factory or service) and is used to test the correct functioning of the RSE. It does this by using any features (attributes, commands and events) and comparing the real results with expected results. If a result doesn't match the expected result, a test fail error is created and appended to a list of all encountered test fails.</p></li></ol></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_selector"></a>Test script selector syntax</h3></div></div></div><div class="table"><a name="test_script_selector_syntax"></a><p class="title"><b>Table 7.16. Attribute <code class="code">default</code> script selector</b></p><div class="table-contents"><table summary="Attribute default script selector" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">test_script_selector</code></td><td><div class="literallayout"><p><code class="code">-&gt; <a href="bk02ch03.html#EBNF_script_test_script_selector">script_test_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_RSE_test_script_selector">RSE_test_script_selector</a></code></p></div></td><td><a href="bk01pt02ch07s07.html" title="test script">the section called &#8220;<code class="code">test</code> script&#8221;</a></td></tr><tr><td><code class="code">script_test_script_selector</code></td><td><code class="code"><a href="bk02ch03.html#EBNF_RSE_script_selector">RSE_script_selector</a> "." "co_test_"</code></td><td> </td></tr><tr><td><code class="code">RSE_test_script_selector</code></td><td><code class="code"><a href="bk02ch03.html#EBNF_RSE_selector">RSE_selector</a> "." "co_test_"</code></td><td> </td></tr></tbody></table></div></div><br class="table-break"></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_input_arguments"></a>Input argument</h3></div></div></div><p>This script has one input argument that holds the list of all test fails encountered. This input argument's id is <code class="code">i_test_fail_list_</code> and its type is <code class="code">ty_test_fail_list</code>. Each time a test fails, an object describing the test fail is automatically appended to <code class="code">i_test_fail_list_</code>.</p><p>Test fails are implicitly generated with the <code class="code">verify</code> and <code class="code">verify error</code> instruction, whenever the expected result differs from the real result.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_output_arguments"></a>Output arguments</h3></div></div></div><p>This script has no output arguments.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_implicit_variables"></a>Implicit variables</h3></div></div></div><p>If the test script is a <span class="emphasis"><em>script test script</em></span> (and not a <span class="emphasis"><em>RSE test script</em></span>) then the following variables are implicitly created by the compiler:</p><div class="itemizedlist"><ul type="disc"><li><p>For each output argument defined in the tested script, a corresponding variable is defined in the test script. The id suffix and type of these variables are the same as those of their corresponding output arguments. Each time a <code class="code">test</code> instruction is executed, all output arguments are implicitly stored in their respective variables. The <code class="code">verify</code> instruction can then use these variables to verify the result(s) of the tested script.</p></li><li><p>If the test script belongs to a factory, then variable <code class="code">v_test_object_</code> is implicitly defined. The type of this variable is the same as the type implemented by the factory (e.g. if factory <code class="code">book</code> implements type <code class="code">book</code>, then variable <code class="code">test_object_</code> is of type <code class="code">book</code>).</p><p>At the beginning of the test script an object must be assigned to <code class="code">v_test_object_</code>. This object is then used by each subsequent <code class="code">test</code> instruction.</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_example"></a>Examples</h3></div></div></div><div class="example"><a name="simple_test_script_example"></a><p class="title"><b>Example 7.3. A simple test script example</b></p><div class="example-contents"><pre class="programlisting">service script_examples

   command double_string
      in string type:string end

      out result type:string end
      
      script
         o_result = i_string &amp; i_string   // simply return twice the input string
      end

      test                                // start of test script
         script
            test "a"                      // call co_double_string with i_string = "a"
            verify v_result =v "aa"       // verify result is "aa"

            test "foo"
            verify result =v "foofoo"

            var string test_string = void
            test test_string              // will produce an input argument check error,
                                          // because i_string cannot be void
            verify error                  // verify an error occured indeed
         end script
      end test
   end command

end</pre><p>The above test script can manually be executed like this:</p><pre class="programlisting">var test_fail_list test_fail_list = fa_test_fail_list.co_create
se_script_examples.co_test_ ( v_test_fail_list )
v_test_fail_list.display_result // display test result on system console</pre></div></div><br class="example-break"><p>For other examples, see:</p><div class="itemizedlist"><ul type="disc"><li><a href="bk01pt02ch04s05.html#triple_apostrophed_string_literals_example" title="Example 4.8. Triple apostrophed string literals">Example 4.8, &#8220;Triple apostrophed string literals&#8221;</a></li><li><a href="bk01pt02ch04s05.html#triple_quoted_string_literals_example" title="Example 4.9. Triple quoted string literals">Example 4.9, &#8220;Triple quoted string literals&#8221;</a></li><li><a href="bk01pt03ch21.html" title="Chapter 21. Testing">Chapter 21, <i>Testing</i></a></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="test_script_see_also"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><a href="bk01pt03ch21.html" title="Chapter 21. Testing">Chapter 21, <i>Testing</i></a></li><li><a href="bk01pt02ch08s07.html#test_instruction" title="test instruction">the section called &#8220;<code class="code">test</code> instruction&#8221;</a></li><li><a href="bk01pt02ch08s07s02.html" title="verify instruction">the section called &#8220;<code class="code">verify</code> instruction&#8221;</a></li><li><a href="bk01pt02ch08s07s03.html" title="verify error instruction">the section called &#8220;<code class="code">verify error</code> instruction&#8221;</a></li><li><a href="bk01pt02ch08.html" title="Chapter 8. Script instructions">Chapter 8, <i>Script instructions</i></a></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="bk01pt02ch07s06s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="bk01pt02ch07.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="bk01pt02ch08.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Input argument <code class="code">default</code> script </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 8. Script instructions</td></tr></table></div></body></html>
