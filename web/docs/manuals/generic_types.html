<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 9. Generic types</title><link rel="stylesheet" href="obix_doc.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="index.html" title="Obix programming language documentation"><link rel="up" href="advanced_concepts.html" title="Part II. Concepts for more reliable code"><link rel="prev" href="static_typing.html" title="Chapter 8. Static typing"><link rel="next" href="feature_redefinition.html" title="Chapter 10. Feature redefinition"><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29648172-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 9. Generic types</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="static_typing.html"><img src="images/prev.png" alt="Previous chapter" title="Previous chapter"></a> </td><th width="60%" align="center">Part II. Concepts for more reliable code</th><td width="20%" align="right"> <a accesskey="n" href="feature_redefinition.html"><img src="images/next.png" alt="Next chapter" title="Next chapter"></a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="generic_types"></a>Chapter 9. Generic types</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">Please note that this chapter is incomplete. An update will be published in the future.</td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="generic_types_description"></a>Description</h2></div></div></div><p>A <em class="firstterm">generic type</em> is a source code template used to define standard types.</p><p>Each generic type has a number of parameters which represent types used within the source code template. Each time the type of an object reference (i.e. the type of an attribute, command input/output argument, constant or variable) is specified in the source code template, a parameter can be used as a placeholder, instead of a hardcoded fixed type. Therefore, generic types are also called <span class="emphasis"><em>parameterized types</em></span>.</p><p>A standard type can be defined by using a generic type and specifying a type for each parameter of the generic type. Such a type created from a generic type is called a <em class="firstterm">generified type</em>.</p><p>Before explaining the precise rules for defining and using generic types, it might be useful to get a first impression with the following simple example:</p><pre class="programlisting">generic type pair

   param item_type end

   type
      attribute item1 type: {item_type} end
      attribute item2 type: {item_type} end
   end

end</pre><p>The above generic type can be used to define any type that represents a pair of items of the same type. The type of the items is denoted by parameter <code class="code">item_type</code>, and that parameter must be enclosed between <code class="code">{</code> and <code class="code">}</code> whenever it is used in the source code.</p><p>A pair of books, for example, can now be defined as follows:</p><pre class="programlisting">type pair_of_books

   !pair&lt;book&gt;

end</pre><p>Here is another generified type; a pair of dogs:</p><pre class="programlisting">type pair_of_dogs

   !pair&lt;dog&gt;

end</pre><p>Without using a generic type, <code class="code">pair_of_dogs</code> would be coded as follows:</p><pre class="programlisting">type pair_of_dogs_

   attribute item1 type: dog end
   attribute item2 type: dog end

end</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This is also the code that the compiler creates when generic type <code class="code">pair</code> is used. However, there are some differences concerning type compatibility, as explained later.</p></td></tr></table></div><p>As we can see so far, generic types are used to define similar types that differ only by their types used for object references.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="generic_types_rules"></a>Rules</h2></div></div></div><div class="orderedlist"><ol type="1"><li><p><span class="emphasis"><em>The syntax for defining a generic type is as follows:</em></span></p><div class="table"><a name="generic_type_syntax_table"></a><p class="title"><b>Table 9.1. Generic type syntax</b></p><div class="table-contents"><table summary="Generic type syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">generic_type</code></td><td>
                <div class="literallayout"><p><code class="code">"generic" "type" ( "id" ":" ) ? <a href="Obix_EBNF.html#EBNF_generic_type_id">generic_type_id</a><br>
   <a href="Obix_EBNF.html#EBNF_generic_parameter">generic_parameter</a> +<br>
   <a href="Obix_EBNF.html#EBNF_type">type</a><br>
"end" "generic" ?</code></p></div>
                <p>Remarks:</p>
                <div class="itemizedlist"><ul type="disc"><li>properties <code class="code">id</code> and <code class="code">default_factory</code> must not be specified for <code class="code">type</code></li><li>each time a <code class="code">generic_parameter</code> is used in the source code of <code class="code">type</code>, it must be enclosed between <code class="code">{</code> and <code class="code">}</code></li></ul></div>
              </td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_type_id</code></td><td><code class="code">"ge_" ? <a href="Obix_EBNF.html#EBNF_identifier">identifier</a></code></td><td> </td></tr><tr><td><code class="code">generic_parameter</code></td><td>
                <div class="literallayout"><p><code class="code">"param" ( "id" ":" ) ? <a href="Obix_EBNF.html#EBNF_generic_parameter_id">generic_parameter_id</a> "end"</code></p></div>
              </td><td> </td></tr><tr><td><code class="code">generic_parameter_id</code></td><td><code class="code">"pa_" ? <a href="Obix_EBNF.html#EBNF_identifier">identifier</a></code></td><td> </td></tr></tbody></table></div></div><br class="table-break"><p>As we can see:</p><div class="itemizedlist"><ul type="disc"><li><p>A generic type is introduced with the keywords <code class="code">generic type</code>.</p></li><li><p>Each generic type is identified by a generic type identifier, which is a prefixed identifier starting with <code class="code">ge_</code></p></li><li><p>Each generic type has one or more parameters which are placeholders for types that will be used for object references in the generified types.</p></li><li><p>Each parameter can be used in the source code of <code class="code">type</code> to specify a variable type for an object reference. The syntax for such a variable type consists of the parameter's identifier enclosed between <code class="code">{</code> and <code class="code">}</code> (e.g. <code class="code">attribute item type: {type_of_item}</code>).</p></li></ul></div><p>Here is a reprint of the above example of a generic type:</p><pre class="programlisting">generic type pair

   param item_type end

   type
      attribute item1 type: {item_type} end
      attribute item2 type: {item_type} end
   end

end</pre></li><li><p><span class="emphasis"><em>The syntax for defining a generified type is as follows:</em></span></p><div class="table"><a name="generified_type_syntax_table"></a><p class="title"><b>Table 9.2. Generified type syntax</b></p><div class="table-contents"><table summary="Generified type syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">generified_type</code></td><td>
                <div class="literallayout"><p><code class="code">"type" ( "id" ":" ) ? <a href="Obix_EBNF.html#EBNF_type_id">type_id</a><br>
   <a href="Obix_EBNF.html#EBNF_generic_type_selector">generic_type_selector</a><br>
"end" "type" ?</code></p></div>
              </td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_type_selector</code></td><td><code class="code">"!" ( <a href="Obix_EBNF.html#EBNF_library_selector">library_selector</a> "." ) ? <a href="Obix_EBNF.html#EBNF_generic_type_id">generic_type_id</a> <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignments">generic_type_parameter_assignments</a> ?</code></td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_type_parameter_assignments</code></td><td><code class="code">"&lt;" <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ( ";" ? <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ) * "&gt;"</code></td><td> </td></tr><tr><td><code class="code">generic_type_parameter_assignment</code></td><td>
                <code class="code">( <a href="Obix_EBNF.html#EBNF_generic_parameter_id">generic_type_parameter_id</a> ":" ) ? <a href="Obix_EBNF.html#EBNF_object_type_selector">object_type_selector</a></code>
                <p>remark: <code class="code">generic_type_parameter_id :</code> can only be omitted if the generic_type has exactly one parameter</p>
              </td><td> </td></tr></tbody></table></div></div><br class="table-break"><p>As we can see, the body of a generified type is introduced by a <code class="code">!</code>, and then simply defined by referencing the generic type and providing an object type for each parameter in the generic type.</p><p>Here is a reprint of the above example of a generified type:</p><pre class="programlisting">type pair_of_books

   !pair&lt;book&gt;

end</pre><p>Generified types are used the same way standard types are used.</p><p>For example, a variable could be declared as:</p><pre class="programlisting">var pair_of_books two_books</pre><p>And, after creating a pair of books, the first book could then be retrieved with:</p><pre class="programlisting">var book first_book = two_books.item1</pre></li><li><p><span class="emphasis"><em>A generified type can also be defined 'on the fly'.</em></span></p><p>'On the fly' means that there is no need to define a type as explained in the previous rule. Instead, the following syntax can be used wherever the type of an object reference (e.g. the type of an attribute) must be specified in source code:</p><div class="table"><a name="generified_on_the_fly_type_syntax_table"></a><p class="title"><b>Table 9.3. 'On the fly' generified type syntax</b></p><div class="table-contents"><table summary="'On the fly' generified type syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">generic_type_selector</code></td><td><code class="code">"!" ( <a href="Obix_EBNF.html#EBNF_library_selector">library_selector</a> "." ) ? <a href="Obix_EBNF.html#EBNF_generic_type_id">generic_type_id</a> <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignments">generic_type_parameter_assignments</a> ?</code></td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_type_parameter_assignments</code></td><td><code class="code">"&lt;" <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ( ";" ? <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ) * "&gt;"</code></td><td> </td></tr><tr><td><code class="code">generic_type_parameter_assignment</code></td><td>
                <code class="code">( <a href="Obix_EBNF.html#EBNF_generic_parameter_id">generic_type_parameter_id</a> ":" ) ? <a href="Obix_EBNF.html#EBNF_object_type_selector">object_type_selector</a></code>
                <p>remark: <code class="code">generic_type_parameter_id :</code> can only be omitted if the generic_type has exactly one parameter</p>
              </td><td> </td></tr></tbody></table></div></div><br class="table-break"><p>As we can see the syntax used to define a generified type 'on the fly' is the same as the syntax used in the previous rule.</p><p>Thus, instead of declaring a variable as shown in the previous rule:</p><pre class="programlisting">var pair_of_books two_books</pre><p>the same can be achieved without defining type <code class="code">pair_of_books</code>, and declaring the variable as follows:</p><pre class="programlisting">var !pair&lt;book&gt; two_books</pre><p>Generified types and 'on the fly' generified types can coexist, even if they use the same type parameters. The compiler automatically checks the parameters for generified types, and if two sets of parameters have the same values, then a single common type is used by the compiler.</p></li><li><p><span class="emphasis"><em>Currently, two generified types that use the same generic type are considered to be type compatible at compile-time, but a runtime error is immediately raised in case of any type incompatibility occurring at runtime.</em></span></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">This rule will change in a future version, so that type compatibility will be verified at compile-time.</td></tr></table></div></li></ol></div><p>The following rules define how to define factories that implement generified types. The rules for factories are analogous to those for types.</p><div class="orderedlist"><ol type="1"><li><p><span class="emphasis"><em>The syntax for defining a generic factory is as follows:</em></span></p><div class="table"><a name="generic_factory_syntax_table"></a><p class="title"><b>Table 9.4. Generic factory syntax</b></p><div class="table-contents"><table summary="Generic factory syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">generic_factory</code></td><td>
                <div class="literallayout"><p><code class="code">"generic" "factory" ( "id" ":" ) ? <a href="Obix_EBNF.html#EBNF_generic_factory_id">generic_factory_id</a><br>
   <a href="Obix_EBNF.html#EBNF_generic_parameter">generic_parameter</a> *<br>
   <a href="Obix_EBNF.html#EBNF_factory">factory</a><br>
"end" "generic" ?</code></p></div>
                <p>Remark: property 'id' must not be specified for 'factory'</p>
              </td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_factory_id</code></td><td><code class="code">"ge_" ? <a href="Obix_EBNF.html#EBNF_identifier">identifier</a></code></td><td> </td></tr><tr><td><code class="code">generic_parameter</code></td><td>
                <div class="literallayout"><p><code class="code">"param" ( "id" ":" ) ? <a href="Obix_EBNF.html#EBNF_generic_parameter_id">generic_parameter_id</a> "end"</code></p></div>
              </td><td> </td></tr><tr><td><code class="code">generic_parameter_id</code></td><td><code class="code">"pa_" ? <a href="Obix_EBNF.html#EBNF_identifier">identifier</a></code></td><td> </td></tr></tbody></table></div></div><br class="table-break"></li><li><p><span class="emphasis"><em>The syntax for defining a generified factory is as follows:</em></span></p><div class="table"><a name="generified_factory_syntax_table"></a><p class="title"><b>Table 9.5. Generified factory syntax</b></p><div class="table-contents"><table summary="Generified factory syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">generified_factory</code></td><td>
                <div class="literallayout"><p><code class="code">"factory" ( "id" ":" ) ? <a href="Obix_EBNF.html#EBNF_factory_id">factory_id</a> "type" ":" <a href="Obix_EBNF.html#EBNF_type_selector">type_selector</a><br>
   <a href="Obix_EBNF.html#EBNF_generic_factory_selector">generic_factory_selector</a><br>
"end" "factory" ?</code></p></div>
              </td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_factory_selector</code></td><td><code class="code">"!" ( <a href="Obix_EBNF.html#EBNF_library_selector">library_selector</a> "." ) ? <a href="Obix_EBNF.html#EBNF_generic_factory_id">generic_factory_id</a> <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignments">generic_type_parameter_assignments</a> ?</code></td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_type_parameter_assignments</code></td><td><code class="code">"&lt;" <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ( ";" ? <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ) * "&gt;"</code></td><td> </td></tr><tr><td><code class="code">generic_type_parameter_assignment</code></td><td>
                <code class="code">( <a href="Obix_EBNF.html#EBNF_generic_parameter_id">generic_type_parameter_id</a> ":" ) ? <a href="Obix_EBNF.html#EBNF_object_type_selector">object_type_selector</a></code>
                <p>remark: <code class="code">generic_type_parameter_id :</code> can only be omitted if the generic_type has exactly one parameter</p>
              </td><td> </td></tr></tbody></table></div></div><br class="table-break"></li><li><p><span class="emphasis"><em>A generified factory can also be defined 'on the fly' with the following syntax:</em></span></p><div class="table"><a name="generified_on_the_fly_factory_syntax_table"></a><p class="title"><b>Table 9.6. 'On the fly' generified factory syntax</b></p><div class="table-contents"><table summary="'On the fly' generified factory syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">generic_factory_selector</code></td><td><code class="code">"!" ( <a href="Obix_EBNF.html#EBNF_library_selector">library_selector</a> "." ) ? <a href="Obix_EBNF.html#EBNF_generic_factory_id">generic_factory_id</a> <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignments">generic_type_parameter_assignments</a> ?</code></td><td><a href="generic_types.html" title="Chapter 9. Generic types">Chapter 9, <i>Generic types</i></a></td></tr><tr><td><code class="code">generic_type_parameter_assignments</code></td><td><code class="code">"&lt;" <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ( ";" ? <a href="Obix_EBNF.html#EBNF_generic_type_parameter_assignment">generic_type_parameter_assignment</a> ) * "&gt;"</code></td><td> </td></tr><tr><td><code class="code">generic_type_parameter_assignment</code></td><td>
                <code class="code">( <a href="Obix_EBNF.html#EBNF_generic_parameter_id">generic_type_parameter_id</a> ":" ) ? <a href="Obix_EBNF.html#EBNF_object_type_selector">object_type_selector</a></code>
                <p>remark: <code class="code">generic_type_parameter_id :</code> can only be omitted if the generic_type has exactly one parameter</p>
              </td><td> </td></tr></tbody></table></div></div><br class="table-break"></li></ol></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="generic_types_see_also"></a>See also</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><a href="static_typing.html" title="Chapter 8. Static typing">Chapter 8, <i>Static typing</i></a></li><li><a href="feature_redefinition.html" title="Chapter 10. Feature redefinition">Chapter 10, <i>Feature redefinition</i></a></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="static_typing.html"><img src="images/prev.png" alt="Previous chapter" title="Previous chapter"></a> </td><td width="20%" align="center"><a accesskey="u" href="advanced_concepts.html"><img src="images/up.png" alt="Go up one level" title="Go up one level"></a></td><td width="40%" align="right"> <a accesskey="n" href="feature_redefinition.html"><img src="images/next.png" alt="Next chapter" title="Next chapter"></a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 8. Static typing </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Table of contents" title="Table of contents"></a></td><td width="40%" align="right" valign="top"> Chapter 10. Feature redefinition</td></tr></table></div></body></html>
