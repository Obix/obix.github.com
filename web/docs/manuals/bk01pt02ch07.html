<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 7. Scripts</title><link rel="stylesheet" href="obix_doc.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="index.html" title="Obix programming language documentation"><link rel="up" href="bk01pt02.html" title="Part II. Language basics"><link rel="prev" href="bk01pt02ch06s04.html" title="Event"><link rel="next" href="bk01pt02ch07s02.html" title="Command script"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 7. Scripts</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="bk01pt02ch06s04.html">Prev</a> </td><th width="60%" align="center">Part II. Language basics</th><td width="20%" align="right"> <a accesskey="n" href="bk01pt02ch07s02.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="scripts"></a>Chapter 7. Scripts</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="bk01pt02ch07.html#script_introduction">Introduction to scripts</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s02.html">Command script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s03.html">Attribute get script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s04.html">Attribute set script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s05.html">Check scripts</a></span></dt><dd><dl><dt><span class="section"><a href="bk01pt02ch07s05.html#attribute_list_check_script"><code class="code">attribute_check</code> script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s05s02.html">Attribute <code class="code">check</code> script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s05s03.html">Command <code class="code">in_check</code> script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s05s04.html">Input argument <code class="code">check</code> script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s05s05.html">Command <code class="code">out_check</code> script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s05s06.html">Output argument <code class="code">check</code> script</a></span></dt></dl></dd><dt><span class="section"><a href="bk01pt02ch07s06.html">Default scripts</a></span></dt><dd><dl><dt><span class="section"><a href="bk01pt02ch07s06.html#attribute_default_script">Attribute <code class="code">default</code> script</a></span></dt><dt><span class="section"><a href="bk01pt02ch07s06s02.html">Input argument <code class="code">default</code> script</a></span></dt></dl></dd><dt><span class="section"><a href="bk01pt02ch07s07.html"><code class="code">test</code> script</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="script_introduction"></a>Introduction to scripts</h2></div></div></div><p>A script belongs to an object or a service and is used to execute a set of instructions in order to complete a specific task.</p><p>A script is composed of</p><div class="itemizedlist"><ul type="disc"><li>input arguments</li><li>output arguments</li><li>instructions</li><li>an optionally appended test script for unit testing</li></ul></div><p>A script can have 0, 1 or more <em class="firstterm">input arguments</em>. Input arguments are objects that are transferred from the script caller to the script. They are created by the script caller and then used within the script. Each input argument is a reference to an object of a defined type, and is accessed through its unique identifier.</p><p>A script can also have 0, 1 or more <em class="firstterm">output arguments</em>. Output arguments are objects that are transferred from the script back to the script caller. They are created by the script and then used by the script caller. Each output argument is a reference to an object of a defined type, and is accessed through its unique identifier.</p><p>Each script contains 1 or more <em class="firstterm">script instructions</em> that are executed in order to complete the script's task. For more information see <a href="bk01pt02ch08.html" title="Chapter 8. Script instructions">Chapter 8, <i>Script instructions</i></a></p><p>A script can optionally contain a <em class="firstterm">test script</em> used to test the correct execution of the script by checking the results for different input values. Test scripts are Obix's means to <em class="firstterm">unit testing</em>. For more information see <a href="bk01pt03ch21.html" title="Chapter 21. Testing">Chapter 21, <i>Testing</i></a></p><p>The following figure shows a schematic representation of a script:</p><div class="figure"><a name="script_figure"></a><p class="title"><b>Figure 7.1. Script</b></p><div class="figure-contents"><div class="mediaobject"><img src="script.gif" alt="Script"></div></div></div><br class="figure-break"><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="script_kinds"></a>Kinds of scripts</h3></div></div></div><p>There are different <em class="firstterm">categories of scripts</em>, subdivided into different <em class="firstterm">kinds of scripts</em>, and each kind of script is used for a specific purpose, as shown in the following table:</p><div class="table"><a name="script_kinds_table"></a><p class="title"><b>Table 7.1. Categories and kinds of scripts</b></p><div class="table-contents"><table summary="Categories and kinds of scripts" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Script category</th><th>Script kind</th><th>Used to</th><th>Arguments implicitly defined</th></tr></thead><tbody><tr><td>command</td><td>command script</td><td>execute a command</td><td>no</td></tr><tr><td rowspan="2" valign="middle">attribute getter/setter</td><td>attribute get script</td><td>get (read) an attribute's value</td><td>yes</td></tr><tr><td>attribute set script</td><td>set (write) an attribute's value</td><td>yes</td></tr><tr><td rowspan="6" valign="middle">check</td><td>command in_check script</td><td>check several input arguments before executing a command</td><td>yes</td></tr><tr><td>input argument check script</td><td>check one input argument before executing a command</td><td>yes</td></tr><tr><td>command out_check script</td><td>check several output arguments after executing a command</td><td>yes</td></tr><tr><td>output argument check script</td><td>check one output argument after executing a command</td><td>yes</td></tr><tr><td>attribute list check script</td><td>check several attributes of an object or service</td><td>yes</td></tr><tr><td>attribute check script</td><td>check one attribute</td><td>yes</td></tr><tr><td rowspan="2" valign="middle">default value</td><td>input argument default script</td><td>define the default value of a command's input argument</td><td>yes</td></tr><tr><td>attribute default script</td><td>define the default value of an attribute</td><td>yes</td></tr><tr><td>test</td><td>test script</td><td>test anyone of the above scripts</td><td>yes</td></tr></tbody></table></div></div><br class="table-break"><p>As we can see from the last column in the above table, a script's input and output arguments are always implicitly defined, except in case of the command script, whose arguments must be explicitly defined in the source code.</p><p>Each kind of script will more thoroughly be explained in subsequent sections.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="script_execution"></a>Executing (calling) a script</h3></div></div></div><p>A script is executed through a <em class="firstterm">script caller</em>, which is a source code instruction or part of a source code expression that calls the script.</p><p>All kinds of scripts, except the command script, are called implicitly. For example, all <span class="emphasis"><em>input</em></span> check scripts are automatically called <span class="emphasis"><em>before</em></span> executing a command, and all <span class="emphasis"><em>output</em></span> check scripts are automatically called <span class="emphasis"><em>after</em></span> executing a command. However, all scripts can also be <span class="emphasis"><em>explicitly</em></span> called at any time. For example, a command input argument check script can manually be called from any script to check if a given value would be accepted as input argument.</p><p>When a script is called explicitly, it is accessed through its <em class="firstterm">script selector</em>. A script selector is an identifier path (i.e. several identifiers separated by a dot) which is unique within the object or service. The syntax of a script selector depends on the script kind and is explained in the following sections.</p><p>The general syntax to call a script is the following:</p><div class="table"><a name="script_execution_syntax"></a><p class="title"><b>Table 7.2. Script execution syntax</b></p><div class="table-contents"><table summary="Script execution syntax" cellspacing="0" cellpadding="5" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Production</th><th>Syntax</th><th>Links</th></tr></thead><tbody><tr><td><code class="code">script_execution_instruction</code></td><td>
                <code class="code"><a href="bk02ch03.html#EBNF_RSE_script_selector">RSE_script_selector</a> <a href="bk02ch03.html#EBNF_input_assignment_list">input_assignment_list</a> ? <a href="bk02ch03.html#EBNF_output_assignment_list">output_assignment_list</a> ? <a href="bk02ch03.html#EBNF_script_execution_tail">script_execution_tail</a> ?</code>
              </td><td><a href="bk01pt02ch08s02s02.html" title="Script execution instruction">the section called &#8220;Script execution instruction&#8221;</a></td></tr><tr><td><code class="code">script_selector</code></td><td><div class="literallayout"><p><code class="code">-&gt; <a href="bk02ch03.html#EBNF_command_script_selector">command_script_selector</a><br>
<br>
-&gt; <a href="bk02ch03.html#EBNF_attribute_get_script_selector">attribute_get_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_attribute_set_script_selector">attribute_set_script_selector</a><br>
<br>
-&gt; <a href="bk02ch03.html#EBNF_command_in_check_script_selector">command_in_check_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_command_out_check_script_selector">command_out_check_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_attribute_list_check_script_selector">attribute_list_check_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_input_argument_check_script_selector">input_argument_check_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_output_argument_check_script_selector">output_argument_check_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_attribute_check_script_selector">attribute_check_script_selector</a><br>
<br>
-&gt; <a href="bk02ch03.html#EBNF_input_argument_default_script_selector">input_argument_default_script_selector</a><br>
-&gt; <a href="bk02ch03.html#EBNF_attribute_default_script_selector">attribute_default_script_selector</a></code></p></div></td><td><a href="bk01pt02ch07.html#script_introduction" title="Introduction to scripts">the section called &#8220;Introduction to scripts&#8221;</a></td></tr><tr><td><code class="code">input_assignment_list</code></td><td><code class="code">"(" <a href="bk02ch03.html#EBNF_input_assignment">input_assignment</a> ( ";" ? <a href="bk02ch03.html#EBNF_input_assignment">input_assignment</a> ) * ")"</code></td><td> </td></tr><tr><td><code class="code">output_assignment_list</code></td><td>
                <code class="code">"(" <a href="bk02ch03.html#EBNF_output_assignment">output_assignment</a> ( ";" ? <a href="bk02ch03.html#EBNF_output_assignment">output_assignment</a> ) * ")"</code>
                <p>remark: if there are no input arguments assigned then the output argument assignment list must be preceded by <code class="code">()</code> to indicate an empty input argument assignment list</p>
              </td><td> </td></tr><tr><td><code class="code">input_assignment</code></td><td>
                <code class="code">( <a href="bk02ch03.html#EBNF_input_argument_id">input_argument_id</a> "=" ) ? <a href="bk02ch03.html#EBNF_expression">expression</a></code>
                <p>remark: <code class="code">input_argument_id =</code> can only be omitted if the called script has exactly one input argument</p>
              </td><td> </td></tr><tr><td><code class="code">output_assignment</code></td><td><code class="code"><a href="bk02ch03.html#EBNF_assignable_object_reference_selector">assignable_object_reference_selector</a> "=" <a href="bk02ch03.html#EBNF_output_argument_id">output_argument_id</a></code></td><td> </td></tr></tbody></table></div></div><br class="table-break"><p>example of calling a script with 2 input and 3 output arguments (from <a href="bk01pt02ch06s02.html#command_examples" title="Examples">the section called &#8220;Examples&#8221;</a>):</p><pre class="programlisting">var string result; file_error
var file log_file

se_logger_7.co_log_message ( &amp;
   i_message = "The sun is shining!!!" &amp;
   i_message_id = "sunshine" ) &amp;
   ( v_result = o_result &amp;
   v_log_file = o_log_file &amp;
   v_file_error = o_file_error )
   
if v_file_error =r void then
   // everything ok
else
   // we have a problem
end if</pre></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="script_implicit_variable_list"></a>Implicit variables</h3></div></div></div><p>Each script has an implicitly defined variable whose id is <code class="code">v_program_error_</code> and whose type is <code class="code">ty_error_program</code>. This variable holds the last error that occurred in the script. It is used infrequently in case of special error handling. Please refer to <a href="bk01pt03ch13.html" title="Chapter 13. Runtime error handling">Chapter 13, <i>Runtime error handling</i></a> for more information.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="bk01pt02ch06s04.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="bk01pt02.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="bk01pt02ch07s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Event </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Command script</td></tr></table></div></body></html>
